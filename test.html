<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>test</title>
    <style>
    *{
    	padding: 0;
    	margin: 0;
    	/*height: 100%;*/
    }
    .wrapper {}
    
    .page {
        height: 200px;
        margin: 10px;
        border: 2px solid silver;
    }
    .page.overflow{
    	border-color: red;
    	box-shadow: 0 0 4px red;
    }
    .page.overflow .question{
    	z-index: 2;
    }
    
    .question {
    	min-height: 44px;
        position: relative;
        margin: 10px;
        outline: 1px solid lime;
        background-color: white;
    }    

    .content{
    	padding: 10px;
    }
    .handle {
        position: absolute;
        right: 1px;
        bottom: 1px;
        width: 20px;
        height: 20px;
        text-align: center;
        line-height: 1;
        cursor: ns-resize;
    }
    
    .handle:after {
        content: "+";
    }
    </style>
</head>

<body ondragstart="return false;" ondragover="return false;" ondrop="return false;">
    <div class="wrapper">
        <div class="page">
            <div class="question">
                <div class="content">asdfadfafdasfda</div>
                <div class="handle"></div>
            </div>
            <div class="question">
                <div class="content">阿发大厦的发发的发发的发阿萨德法师打发阿发大厦的发发的发发的发阿萨德法师打发阿发大厦的发发的发发的发阿萨德法师打发阿发大厦的发发的发发的发阿萨德法师打发阿发大厦的发发的发发的发阿萨德法师打发</div>
                <div class="handle"></div>
            </div>
        </div>
        <div class="page">
            <div class="question">
                <div class="content">asdfadfafdasfda</div>
                <div class="handle"></div>
            </div>
            <div class="question">
                <div class="content">阿发大厦的发发的发发的发阿萨德法师打发阿发大厦的发发的发发的发阿萨德法师打发阿发大厦的发发的发发的发阿萨德法师打发阿发大厦的发发的发发的发阿萨德法师打发阿发大厦的发发的发发的发阿萨德法师打发</div>
                <div class="handle"></div>
            </div>
        </div>
    </div>
    <script type="text/template" id="tpl-question">
    	<div class="question">
    		<div class="content"></div>
    		<div class="handle"></div>
    	</div>
    </script>
    <script src="jquery/jquery.js"></script>
    <script>

    var activeQue = null; // 当前拖拽的元素
    var pageHeight = $('.question').height();
    var pageData = [
    	{
    		index: 0, // 页码
    		queList: [
	    		{
	    			type: 0,// 题型
	    			index: 0, // 索引
	    			owner: 0, // 所属page
	    			height: ''
	    		},
	    		{
	    			type: 0,
	    			index: 1,
	    			owner: 0,
	    			height: ''
	    		}
    		]
    	},
    	{
    		index: 1,
    		queList: [
	    		{
	    			type: 1,
	    			index: 0,
	    			owner: 1,
	    			height: ''
	    		},
	    		{
	    			type: 1,
	    			index: 1,
	    			owner: 1,
	    			height: ''
	    		}
    		]
    	}
    ];

    $(document).on('mousedown', '.handle', function(e) {
        activeQue = $(this).parents('.question');
        activeQue.data('startH', activeQue.height());
        activeQue.data('startY', e.pageY);
    });

    $(document).on('mousemove', function(e) {

        if (!activeQue) return;

    	e.preventDefault();

    	var page = activeQue.parents('.page');
        var offsetY = e.pageY -activeQue .data('startY');
        var h = activeQue.data('startH') + offsetY;

        if (offsetY > 0 || activeQue.innerHeight() >= activeQue[0].scrollHeight) {
	        activeQue.height(h);
	        if (page.innerHeight() < page[0].scrollHeight) {
	        	page.addClass('overflow');
	        	if (!activeQue.data('maxH')) {
		        	activeQue.data('maxH', h - (page[0].scrollHeight - page.innerHeight()));
	        	}
	        } else {
	        	page.removeClass('overflow');
	        }
        };

        activeQue.data('offsetY', offsetY);
    });

    $(document).on('mouseup', function(e) {

    	if (!activeQue) return;

    	var page = activeQue.parents('.page');

    	if (activeQue.innerHeight() < activeQue[0].scrollHeight) {
    		activeQue.height(activeQue[0].scrollHeight);
    	};

    	// 拖动超出page
    	if (page.hasClass('overflow')) {
    		// 为page的最后一个question
    		if (activeQue.is(':last-child')) {
    			page.next().prepend($($('#tpl-question').html()).height(activeQue.height() - activeQue.data('maxH')));
    			activeQue.height(activeQue.data('maxH'));
    		}
    	};

    	page.removeClass('overflow');
    	activeQue = null;
    });

    function update() {
    	//
    }
    </script>
</body>

</html>
